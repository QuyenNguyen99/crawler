/*BEGIN F9_APP_INSIGHT USER_INTEREST*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_INTEREST"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "STRENGTH" INTEGER, 
    "INTEREST_ID" INTEGER NOT NULL,
    "INTEREST_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_INTEREST" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "INTEREST_ID")
ENFORCED ;
CREATE INDEX USER_INTEREST_INTEREST_ID_IDX ON F9_APP_INSIGHT.USER_INTEREST (INTEREST_ID);
CREATE INDEX USER_INTEREST_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_INTEREST (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_INTEREST*/


/*BEGIN F9_APP_INSIGHT USER_HOMETOWN*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_HOMETOWN"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "HOMETOWN_ID" INTEGER NOT NULL, 
    "HOMETOWN_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "TOWN_ID" INTEGER, 
    "TOWN_NAME" VARCHAR(1000 OCTETS), 
    "DOMAIN_ID" INTEGER, 
    "DOMAIN_NAME" VARCHAR(1000 OCTETS))   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID", "TYPE")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_HOMETOWN" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE") ENFORCED ;
CREATE INDEX USER_HOMETOWN_HOMETOWN_ID_IDX ON F9_APP_INSIGHT.USER_HOMETOWN (HOMETOWN_ID);
CREATE INDEX USER_HOMETOWN_TOWN_ID_IDX ON F9_APP_INSIGHT.USER_HOMETOWN (TOWN_ID);
CREATE INDEX USER_HOMETOWN_DOMAIN_ID_IDX ON F9_APP_INSIGHT.USER_HOMETOWN (DOMAIN_ID);
CREATE INDEX USER_HOMETOWN_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_HOMETOWN (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_HOMETOWN*/

/*BEGIN F9_APP_INSIGHT USER_GENDER*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_GENDER"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "GENDER" VARCHAR(10 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_GENDER" ADD PRIMARY KEY ("FACEBOOK_ID") ENFORCED ;
CREATE INDEX USER_GENDER_GENDER_IDX ON F9_APP_INSIGHT.USER_GENDER (GENDER);
*/
/*END F9_APP_INSIGHT USER_GENDER*/

/*BEGIN F9_APP_INSIGHT USER_RELATIONSHIP_STATUS*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_RELATIONSHIP_STATUS"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "RELATIONSHIP_STATUS" VARCHAR(40 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_RELATIONSHIP_STATUS" ADD PRIMARY KEY ("FACEBOOK_ID") ENFORCED ;
CREATE INDEX USER_RELATIONSHIP_STATUS_RELATIONSHIP_STATUS_IDX ON F9_APP_INSIGHT.USER_RELATIONSHIP_STATUS (RELATIONSHIP_STATUS);
*/
/*END F9_APP_INSIGHT USER_RELATIONSHIP_STATUS*/


/*BEGIN F9_APP_INSIGHT USER_LOCATION*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_LOCATION"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "LOCATION_ID" INTEGER NOT NULL, 
    "LOCATION_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "TOWN_ID" INTEGER, 
    "TOWN_NAME" VARCHAR(1000 OCTETS), 
    "DOMAIN_ID" INTEGER, 
    "DOMAIN_NAME" VARCHAR(1000 OCTETS))   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID", "TYPE")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_LOCATION" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE") ENFORCED ;
CREATE INDEX USER_LOCATION_LOCATION_ID_IDX ON F9_APP_INSIGHT.USER_LOCATION (LOCATION_ID);
CREATE INDEX USER_LOCATION_TOWN_ID_IDX ON F9_APP_INSIGHT.USER_LOCATION (TOWN_ID);
CREATE INDEX USER_LOCATION_DOMAIN_ID_IDX ON F9_APP_INSIGHT.USER_LOCATION (DOMAIN_ID);
CREATE INDEX USER_LOCATION_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_LOCATION (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_LOCATION*/


/*BEGIN F9_APP_INSIGHT USER_AGE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_AGE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "AGE" INTEGER NOT NULL, 
    "YEAR" INTEGER NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID", "TYPE")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_AGE" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE") ENFORCED ;
CREATE INDEX USER_AGE_AGE_ID_IDX ON F9_APP_INSIGHT.USER_AGE (AGE);
CREATE INDEX USER_AGE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_AGE (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_AGE*/

/*BEGIN F9_APP_INSIGHT USER_SCHOOL_3*/
/*
DROP TABLE "F9_APP_INSIGHT"."USER_SCHOOL_3";
CREATE TABLE "F9_APP_INSIGHT"."USER_SCHOOL_3"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "SCHOOL_3_ID" INTEGER NOT NULL, 
    "SCHOOL_3_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "SCHOOL_3_CITY_ID" INTEGER ,
    "SCHOOL_3_CITY_NAME" VARCHAR(255 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_SCHOOL_3" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE", "SCHOOL_3_ID") ENFORCED ;
CREATE INDEX USER_SCHOOL_3_SCHOOL_3_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_3 (SCHOOL_3_ID);
CREATE INDEX USER_SCHOOL_3_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_3 (FACEBOOK_ID);
CREATE INDEX USER_SCHOOL_3_SCHOOL_3_CITY_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_3 (SCHOOL_3_CITY_ID);
*/
/*END F9_APP_INSIGHT USER_SCHOOL_3*/


/*BEGIN F9_APP_INSIGHT USER_SCHOOL_2*/
/*
DROP TABLE "F9_APP_INSIGHT"."USER_SCHOOL_2";
CREATE TABLE "F9_APP_INSIGHT"."USER_SCHOOL_2"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "SCHOOL_2_ID" INTEGER NOT NULL, 
    "SCHOOL_2_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "SCHOOL_2_CITY_ID" INTEGER ,
    "SCHOOL_2_CITY_NAME" VARCHAR(255 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_SCHOOL_2" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE", "SCHOOL_2_ID") ENFORCED ;
CREATE INDEX USER_SCHOOL_2_SCHOOL_2_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_2 (SCHOOL_2_ID);
CREATE INDEX USER_SCHOOL_2_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_2 (FACEBOOK_ID);
CREATE INDEX USER_SCHOOL_2_SCHOOL_2_CITY_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_2 (SCHOOL_2_CITY_ID);
*/
/*END F9_APP_INSIGHT USER_SCHOOL_2*/

/*BEGIN F9_APP_INSIGHT USER_SCHOOL_1*/
/*
DROP TABLE "F9_APP_INSIGHT"."USER_SCHOOL_1";
CREATE TABLE "F9_APP_INSIGHT"."USER_SCHOOL_1"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "SCHOOL_1_ID" INTEGER NOT NULL, 
    "SCHOOL_1_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "SCHOOL_1_CITY_ID" INTEGER ,
    "SCHOOL_1_CITY_NAME" VARCHAR(255 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_SCHOOL_1" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE", "SCHOOL_1_ID") ENFORCED ;
CREATE INDEX USER_SCHOOL_1_SCHOOL_1_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_1 (SCHOOL_1_ID);
CREATE INDEX USER_SCHOOL_1_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_1 (FACEBOOK_ID);
CREATE INDEX USER_SCHOOL_1_SCHOOL_1_CITY_ID_IDX ON F9_APP_INSIGHT.USER_SCHOOL_1 (SCHOOL_1_CITY_ID);
*/
/*END F9_APP_INSIGHT USER_SCHOOL_1*/


/*BEGIN F9_APP_INSIGHT USER_COLLEGE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_COLLEGE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "COLLEGE_ID" INTEGER NOT NULL, 
    "COLLEGE_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "COLLEGE_CITY_ID" INTEGER ,
    "COLLEGE_CITY_NAME" VARCHAR(255 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID", "TYPE", "COLLEGE_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_COLLEGE" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE", "COLLEGE_ID") ENFORCED ;
CREATE INDEX USER_COLLEGE_COLLEGE_ID_IDX ON F9_APP_INSIGHT.USER_COLLEGE (COLLEGE_ID);
CREATE INDEX USER_COLLEGE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_COLLEGE (FACEBOOK_ID);
CREATE INDEX USER_COLLEGE_COLLEGE_CITY_ID_IDX ON F9_APP_INSIGHT.USER_COLLEGE (COLLEGE_CITY_ID);
*/
/*END F9_APP_INSIGHT USER_COLLEGE*/



/*BEGIN F9_APP_INSIGHT USER_COMPANY*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_COMPANY"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "TYPE"  VARCHAR(15 OCTETS) NOT NULL , 
    "COMPANY_ID" INTEGER NOT NULL, 
    "COMPANY_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "COMPANY_CITY_ID" INTEGER ,
    "COMPANY_CITY_NAME" VARCHAR(255 OCTETS), 
    "COMPANY_BLOCK_ID" INTEGER ,
    "COMPANY_BLOCK_NAME" VARCHAR(255 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID", "TYPE", "COMPANY_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_COMPANY" ADD PRIMARY KEY ("FACEBOOK_ID", "TYPE", "COMPANY_ID") ENFORCED ;
CREATE INDEX USER_COMPANY_COMPANY_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (COMPANY_ID);
CREATE INDEX USER_COMPANY_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (FACEBOOK_ID);
CREATE INDEX USER_COMPANY_COMPANY_CITY_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (COMPANY_CITY_ID);
CREATE INDEX USER_COMPANY_COMPANY_BLOCK_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (COMPANY_BLOCK_ID);
*/
/*END F9_APP_INSIGHT USER_COMPANY*/



/*BEGIN F9_APP_INSIGHT USER_LANGUAGE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_LANGUAGE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "LANGUAGE_ID" INTEGER NOT NULL, 
    "LANGUAGE_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "LANGUAGE_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_LANGUAGE" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "LANGUAGE_ID")
ENFORCED ;
CREATE INDEX USER_LANGUAGE_LANGUAGE_ID_ID_IDX ON F9_APP_INSIGHT.USER_LANGUAGE (LANGUAGE_ID);
CREATE INDEX USER_LANGUAGE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_LANGUAGE (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_LANGUAGE*/




/*BEGIN F9_APP_INSIGHT USER_NATION*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_NATION"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "NATION_ID" INTEGER NOT NULL, 
    "NATION_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "NATION_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_NATION" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "NATION_ID")
ENFORCED ;
CREATE INDEX USER_NATION_NATION_ID_ID_IDX ON F9_APP_INSIGHT.USER_NATION (NATION_ID);
CREATE INDEX USER_NATION_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_NATION (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_NATION*/



/*BEGIN F9_APP_INSIGHT USER_REGILION*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_REGILION"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "REGILION_ID" INTEGER NOT NULL, 
    "REGILION_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "REGILION_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_REGILION" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "REGILION_ID")
ENFORCED ;
CREATE INDEX USER_REGILION_REGILION_ID_ID_IDX ON F9_APP_INSIGHT.USER_REGILION (REGILION_ID);
CREATE INDEX USER_REGILION_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_REGILION (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_REGILION*/



/*BEGIN F9_APP_INSIGHT USER_PARENT*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PARENT"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "PARENT_ID" INTEGER NOT NULL, 
    "PARENT_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "PARENT_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PARENT" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "PARENT_ID")
ENFORCED ;
CREATE INDEX USER_PARENT_PARENT_ID_ID_IDX ON F9_APP_INSIGHT.USER_PARENT (PARENT_ID);
CREATE INDEX USER_PARENT_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PARENT (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_PARENT*/

/*BEGIN F9_APP_INSIGHT USER_COMPANY*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_COMPANY"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "COMPANY_ID" INTEGER NOT NULL, 
    "COMPANY_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "COMPANY_CITY_ID" INTEGER , 
    "COMPANY_CITY_NAME" VARCHAR(1000 OCTETS), 
    "COMPANY_BLOCK_ID" INTEGER , 
    "COMPANY_BLOCK_NAME" VARCHAR(1000 OCTETS) )   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "COMPANY_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_COMPANY" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "COMPANY_ID")
ENFORCED ;
CREATE INDEX USER_PARENT_PARENT_ID_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (COMPANY_ID);
CREATE INDEX USER_PARENT_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_COMPANY (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT COMPANY_ID*/


/*BEGIN F9_APP_INSIGHT USER_REAL_ESTATED*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_REAL_ESTATED"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "REAL_ESTATED_ID" INTEGER NOT NULL, 
    "REAL_ESTATED_NAME" VARCHAR(1000 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "REAL_ESTATED_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_REAL_ESTATED" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "REAL_ESTATED_ID")
ENFORCED ;
CREATE INDEX USER_REAL_ESTATED_REAL_ESTATED_ID_ID_IDX ON F9_APP_INSIGHT.USER_REAL_ESTATED (REAL_ESTATED_ID);
CREATE INDEX USER_REAL_ESTATED_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_REAL_ESTATED (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_REAL_ESTATED*/


/*BEGIN F9_APP_INSIGHT USER_PROFILE_NAME*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PROFILE_NAME"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "NAME" varchar(255 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "NAME")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PROFILE_NAME" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "NAME")
ENFORCED ;
CREATE INDEX USER_PROFILE_NAME_NAME_IDX ON F9_APP_INSIGHT.USER_PROFILE_NAME (NAME);
CREATE INDEX USER_PROFILE_NAME_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PROFILE_NAME (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_PROFILE_NAME*/



/*BEGIN F9_APP_INSIGHT USER_PROFILE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PROFILE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "GENDER" VARCHAR(15), 
    "NAME" VARCHAR(1000), 
    "USERNAME" VARCHAR(255), 
    "BIRTHDAY" VARCHAR(255), 
    "RELATIONSHIP_STATUS" VARCHAR(100))   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PROFILE" 
ADD PRIMARY KEY
  ("FACEBOOK_ID")
ENFORCED ;
CREATE INDEX USER_PROFILE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PROFILE (FACEBOOK_ID);
CREATE INDEX USER_PROFILE_GENDER_IDX ON F9_APP_INSIGHT.USER_PROFILE (GENDER);
CREATE INDEX USER_PROFILE_RELATIONSHIP_STATUS_IDX ON F9_APP_INSIGHT.USER_PROFILE (relationship_status);
*/
/*END F9_APP_INSIGHT USER_PROFILE*/




/*BEGIN F9_APP_INSIGHT USER_PROFILE_NEW*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PROFILE_NEW"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "GENDER" VARCHAR(15), 
    "NAME" VARCHAR(1000), 
    "USERNAME" VARCHAR(255), 
    "BIRTHDAY" VARCHAR(255), 
    "RELATIONSHIP_STATUS" VARCHAR(100))   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PROFILE_NEW" 
ADD PRIMARY KEY
  ("FACEBOOK_ID")
ENFORCED ;
CREATE INDEX USER_PROFILE_NEW_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PROFILE_NEW (FACEBOOK_ID);
CREATE INDEX USER_PROFILE_NEW_GENDER_IDX ON F9_APP_INSIGHT.USER_PROFILE_NEW (GENDER);
CREATE INDEX USER_PROFILE_NEW_USERNAME_IDX ON F9_APP_INSIGHT.USER_PROFILE_NEW (USERNAME);
CREATE INDEX USER_PROFILE_NEW_NAME_IDX ON F9_APP_INSIGHT.USER_PROFILE_NEW (NAME);
CREATE INDEX USER_PROFILE_NEW_RELATIONSHIP_STATUS_IDX ON F9_APP_INSIGHT.USER_PROFILE_NEW (relationship_status);
*/
/*END F9_APP_INSIGHT USER_PROFILE_NEW*/


/*BEGIN F9_APP_INSIGHT USER_GROUP*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_GROUP"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "GROUP_ID" varchar(20 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "GROUP_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_GROUP" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "GROUP_ID")
ENFORCED ;
CREATE INDEX USER_GROUP_GROUP_ID_IDX ON F9_APP_INSIGHT.USER_GROUP (GROUP_ID);
CREATE INDEX USER_GROUP_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_GROUP (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_GROUP*/


/*BEGIN F9_APP_INSIGHT USER_PAGE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PAGE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "PAGE_ID" varchar(20 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "PAGE_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PAGE" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "PAGE_ID")
ENFORCED ;
CREATE INDEX USER_PAGE_PAGE_ID_IDX ON F9_APP_INSIGHT.USER_PAGE (PAGE_ID);
CREATE INDEX USER_PAGE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PAGE (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_PAGE*/

/*BEGIN F9_APP_INSIGHT USER_FRIEND*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_FRIEND"  (
    "ID1" varchar(15 OCTETS) NOT NULL, 
    "ID2" varchar(15 OCTETS) NOT NULL)   
   COMPRESS YES STATIC DISTRIBUTE BY HASH("ID1","ID2") IN "USERSPACE1" ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_FRIEND" ADD PRIMARY KEY ("ID1","ID2") ENFORCED ;
CREATE INDEX USER_FRIEND_ID1_IDX ON F9_APP_INSIGHT.USER_FRIEND (ID1);
CREATE INDEX USER_FRIEND_ID2_IDX ON F9_APP_INSIGHT.USER_FRIEND (ID2);
*/
/*END F9_APP_INSIGHT USER_FRIEND*/



/*BEGIN F9_APP_INSIGHT USER_PAGE*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PAGE"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "PAGE_ID" varchar(20 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "PAGE_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PAGE" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "PAGE_ID")
ENFORCED ;
CREATE INDEX USER_PAGE_NAME_IDX ON F9_APP_INSIGHT.USER_PAGE (PAGE_ID);
CREATE INDEX USER_PAGE_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PAGE (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_PAGE*/


/*BEGIN F9_APP_INSIGHT USER_INCOME*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_INCOME"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "INCOME_ID" varchar(20 OCTETS) NOT NULL)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID",  
   "INCOME_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_INCOME" 
ADD PRIMARY KEY
  ("FACEBOOK_ID",
   "INCOME_ID")
ENFORCED ;
CREATE INDEX USER_INCOME_INCOME_ID_IDX ON F9_APP_INSIGHT.USER_INCOME (INCOME_ID);
CREATE INDEX USER_INCOME_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_INCOME (FACEBOOK_ID);
*/
/*END F9_APP_INSIGHT USER_INCOME*/



/*BEGIN FRIEND CALC SHOOL_3 INFER*/
/*
SELECT a.school_3_id,listagg(DISTINCT a.c,',') AS total_sizes, count(*) AS total_links FROM (
SELECT a.facebook_id,a.school_3_id,list_facebook_id,c FROM user_school_3 a
INNER JOIN user_friend c ON a.facebook_id = c.id2 AND c.id1 = '100000696780165'
INNER JOIN (SELECT school_3_id,concat(concat(' ',listagg(facebook_id,' ')),' ') AS list_facebook_id, count(*) AS c FROM user_school_3 WHERE facebook_id IN (SELECT id2 FROM user_friend WHERE id1 = '100000696780165') GROUP BY school_3_id ORDER BY c DESC LIMIT 3) b ON a.school_3_id = b.school_3_id 
) a
INNER JOIN user_friend b ON a.facebook_id = b.id1 AND a.list_facebook_id LIKE concat(concat('% ',b.id2),' %') 
GROUP BY a.school_3_id
*/
/*END FRIEND CALC SHOOL_3 INFER*/




/*BEGIN F9_APP_INSIGHT USER_PROFILE_ALL*/
/*
CREATE TABLE "F9_APP_INSIGHT"."USER_PROFILE_ALL"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "GENDER" VARCHAR(15), 
    "NAME" VARCHAR(1000), 
    "USERNAME" VARCHAR(255), 
    "BIRTHDAY" VARCHAR(255), 
    "RELATIONSHIP_STATUS" VARCHAR(100), 
    "FOLLOWER_COUNT" INTERGER, 
    "FRIEND_COUNT" INTERGER)   
   COMPRESS YES STATIC  
   DISTRIBUTE BY HASH("FACEBOOK_ID")   
     IN "USERSPACE1"  
   ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."USER_PROFILE_ALL" 
ADD PRIMARY KEY
  ("FACEBOOK_ID")
ENFORCED ;
CREATE INDEX USER_PROFILE_ALL_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.USER_PROFILE_ALL (FACEBOOK_ID);
CREATE INDEX USER_PROFILE_ALL_GENDER_IDX ON F9_APP_INSIGHT.USER_PROFILE_ALL (GENDER);
CREATE INDEX USER_PROFILE_ALL_RELATIONSHIP_STATUS_IDX ON F9_APP_INSIGHT.USER_PROFILE_ALL (relationship_status);
CREATE INDEX USER_PROFILE_ALL_FOLLOWER_COUNT_IDX ON F9_APP_INSIGHT.USER_PROFILE_ALL (FOLLOWER_COUNT);
*/
/*END F9_APP_INSIGHT USER_PROFILE_ALL*/


/*BEGIN F9_APP_INSIGHT FACEBOOK_USER_HOMETOWN*/
DROP TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_HOMETOWN";
CREATE TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_HOMETOWN"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "DATA" VARCHAR(20 OCTETS) NOT NULL, 
    "DATA_NAME" VARCHAR(1000 OCTETS) NOT NULL
  )   COMPRESS YES STATIC  DISTRIBUTE BY HASH("FACEBOOK_ID")   IN "USERSPACE1"  ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_HOMETOWN" ADD PRIMARY KEY ("FACEBOOK_ID") ENFORCED ;
CREATE INDEX FACEBOOK_USER_HOMETOWN_DATA_IDX ON F9_APP_INSIGHT.FACEBOOK_USER_HOMETOWN (DATA);
CREATE INDEX FACEBOOK_USER_HOMETOWN_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.FACEBOOK_USER_HOMETOWN (FACEBOOK_ID);
/*END F9_APP_INSIGHT FACEBOOK_USER_HOMETOWN*/



/*BEGIN F9_APP_INSIGHT FACEBOOK_USER_LOCATION*/
DROP TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_LOCATION";
CREATE TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_LOCATION"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "DATA" VARCHAR(20 OCTETS) NOT NULL, 
    "DATA_NAME" VARCHAR(1000 OCTETS) NOT NULL
  )   COMPRESS YES STATIC  DISTRIBUTE BY HASH("FACEBOOK_ID")   IN "USERSPACE1"  ORGANIZE BY ROW  ;
ALTER TABLE "F9_APP_INSIGHT"."FACEBOOK_USER_LOCATION" ADD PRIMARY KEY ("FACEBOOK_ID") ENFORCED ;
CREATE INDEX FACEBOOK_USER_LOCATION_DATA_IDX ON F9_APP_INSIGHT.FACEBOOK_USER_LOCATION (DATA);
CREATE INDEX FACEBOOK_USER_LOCATION_FACEBOOK_ID_IDX ON F9_APP_INSIGHT.FACEBOOK_USER_LOCATION (FACEBOOK_ID);
/*END F9_APP_INSIGHT FACEBOOK_USER_LOCATION*/


/*BEGIN F9_STG_INSIGHT FACEBOOK_USER_LANGUAGES_NEW*/
DROP TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_LANGUAGES_NEW";
CREATE TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_LANGUAGES_NEW"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "SOURCE_ID" VARCHAR(20 OCTETS) NOT NULL, 
    "SOURCE_NAME" VARCHAR(1000 OCTETS) NOT NULL,
    "UNI_KEY" VARCHAR(35 OCTETS) NOT NULL
  )   COMPRESS YES STATIC  DISTRIBUTE BY HASH("FACEBOOK_ID")   IN "USERSPACE1"  ORGANIZE BY ROW  ;
ALTER TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_LANGUAGES_NEW" ADD PRIMARY KEY ("FACEBOOK_ID","SOURCE_ID") ENFORCED ;
CREATE INDEX FACEBOOK_USER_LANGUAGES_NEW_SOURCE_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_LANGUAGES_NEW (SOURCE_ID);
CREATE INDEX FACEBOOK_USER_LANGUAGES_NEW_FACEBOOK_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_LANGUAGES_NEW (FACEBOOK_ID);
CREATE INDEX FACEBOOK_USER_LANGUAGES_NEW_UNI_KEY_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_LANGUAGES_NEW (UNI_KEY);
/*END F9_STG_INSIGHT FACEBOOK_USER_LANGUAGES*/

/*BEGIN F9_APP_INSIGHT FACEBOOK_USER_EDUCATION*/
DROP TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_EDUCATION_NEW";
CREATE TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_EDUCATION_NEW"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "SOURCE_ID" VARCHAR(20 OCTETS) NOT NULL, 
    "SOURCE_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "TYPE" VARCHAR(50 OCTETS), 
    "YEAR" VARCHAR(50 OCTETS), 
    "ID" VARCHAR(20 OCTETS) NOT NULL
  )   COMPRESS YES STATIC DISTRIBUTE BY HASH("ID") IN "USERSPACE1" ORGANIZE BY ROW NOT LOGGED INITIALLY;
ALTER TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_EDUCATION_NEW" ADD PRIMARY KEY ("ID") ENFORCED ;
CREATE INDEX FACEBOOK_USER_EDUCATION_NEW1_SOURCE_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_EDUCATION_NEW (SOURCE_ID);
CREATE INDEX FACEBOOK_USER_EDUCATION_NEW1_FACEBOOK_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_EDUCATION_NEW (FACEBOOK_ID);
CREATE INDEX FACEBOOK_USER_EDUCATION_NEW1_TYPE_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_EDUCATION_NEW (TYPE);
/*END F9_APP_INSIGHT FACEBOOK_USER_EDUCATION*/

/*BEGIN F9_APP_INSIGHT FACEBOOK_USER_WORK*/
DROP TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_WORK_NEW";
CREATE TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_WORK_NEW"  (
    "FACEBOOK_ID" VARCHAR(15 OCTETS) NOT NULL , 
    "SOURCE_ID" VARCHAR(20 OCTETS) NOT NULL, 
    "SOURCE_NAME" VARCHAR(1000 OCTETS) NOT NULL, 
    "POSITION_ID" VARCHAR(20 OCTETS), 
    "POSITION_NAME" VARCHAR(1000 OCTETS), 
    "START_DATE" VARCHAR(20 OCTETS), 
    "END_DATE" VARCHAR(20 OCTETS), 
    "ID" VARCHAR(20 OCTETS) NOT NULL
  )   COMPRESS YES STATIC DISTRIBUTE BY HASH("ID") IN "USERSPACE1" ORGANIZE BY ROW NOT LOGGED INITIALLY;
ALTER TABLE "F9_STG_INSIGHT"."FACEBOOK_USER_WORK_NEW" ADD PRIMARY KEY ("ID") ENFORCED ;
CREATE INDEX FACEBOOK_USER_WORK_NEW1_SOURCE_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_WORK_NEW (SOURCE_ID);
CREATE INDEX FACEBOOK_USER_WORK_NEW1_FACEBOOK_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_WORK_NEW (FACEBOOK_ID);
CREATE INDEX FACEBOOK_USER_WORK_NEW1_POSITION_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_WORK_NEW (POSITION_ID);
CREATE INDEX FACEBOOK_USER_WORK_NEW1_ID_IDX ON F9_STG_INSIGHT.FACEBOOK_USER_WORK_NEW (ID);
/*END F9_APP_INSIGHT FACEBOOK_USER_WORK*/

/*
SELECT a.FACEBOOK_ID
,max(a.NAME) NAME
,max(a.GENDER) GENDER
,max(a.BIRTHDAY) BIRTHDAY
,max(a.RELATIONSHIP_STATUS) RELATIONSHIP_STATUS 
,max(a.FOLLOWER_COUNT) FOLLOWER_COUNT
,listagg(distinct b.COMPANY_NAME,', ') COMPANY_NAME 
,listagg(distinct c.SCHOOL_3_NAME,', ') SCHOOL_3_NAME
,listagg(distinct d.COLLEGE_NAME,', ') COLLEGE_NAME
FROM USER_PROFILE_ALL a
LEFT JOIN MQT_USER_COMPANY b ON a.FACEBOOK_ID = b.FACEBOOK_ID
LEFT JOIN USER_SCHOOL_3 c ON a.FACEBOOK_ID = c.FACEBOOK_ID
LEFT JOIN USER_COLLEGE d ON a.FACEBOOK_ID = d.FACEBOOK_ID
WHERE a.FACEBOOK_ID IN ('100003141668309','100005062659730','100004186658503','100004419366153','100003873465023','100004314042542','100009943062325','100005705238653','100005393291099','100008766099478','100004093083140','100006456523197','100006586451011','100006466505528','100010718947632','100003721592401','100001687233614','100000323843939','100005535396546','100000261035049','100001380568029','100008393652930','100010027747387','100010900033292','100004798964670','100001782151064','100001205456448','100026089244314','100015891003359','100004067806447','100005346999363','100017307782359','100006509617684','100000152135532','100005380625527','100004237959583','1793140471','100003505220037','100000694056582','100002333045610','100003927808222','100021104113076','100001420867835','100003844724172','100007510743260','100010765142060','100005805944835','100007955958379','100011464642446','100004526112196','100002454408697','1677136898','100000926675349','100006811480524','100011383314895','100010507804834','100004023409166','100010015422753','100027530264663','100004569274571','1708674103','100006307922973','100005649870680','100004002108884','100005506389035','100004630246807','100006250599107','100004654004077','100013284497860','100005469275221','100001324523491','100018146804087','100015424247065','100005514880065','100004559677198','100004413638886','100006635138737','100008429534048','100007815032057','100005443062786','100000464490927','100000282736778','100004221843221','1816977811','100004719574338','100007544623670','100010786086394','100008035065005','100004434752455','100009232230729','100004666568279','100005952673484','100009747691328','100005813105084','100005478048981','100015640907995')
GROUP BY a.FACEBOOK_ID;

SELECT a.FACEBOOK_ID,a.FRIEND_ID,a.PHONE_NUMBER,upa.NAME,a.SUM1
,listagg(uc_b.COMPANY_NAME,',\r\n') COMPANY_PARENT
, listagg(uc_c.COMPANY_NAME,',\r\n') COMPANY_CHILD
,listagg(ucc_b.COLLEGE_NAME,',\r\n') COLLEGE_PARENT
, listagg(ucc_c.COLLEGE_NAME,',\r\n') COLLEGE_CHILD
FROM (
SELECT a.* FROM (
SELECT a.id1 FACEBOOK_ID,a.id2 FRIEND_ID,d.PHONE_NUMBER,count(*) AS SUM1,ROW_NUMBER() OVER (PARTITION BY a.id1 order by count(*) desc) as rownumber FROM F9_APP_INSIGHT.user_friend a 
    INNER JOIN F9_REF_DEV.PHONE_NUMBER_60M d ON a.id2 = d.fACEBOOK_ID
    INNER JOIN F9_APP_INSIGHT.user_friend b ON a.id2 = b.id1 
    INNER JOIN F9_APP_INSIGHT.user_friend c ON b.id2 = c.id1 AND c.id2 = a.id1
    WHERE a.id1 IN ('100003141668309','100005062659730','100004186658503','100004419366153','100003873465023','100004314042542','100009943062325','100005705238653','100005393291099','100008766099478','100004093083140','100006456523197','100006586451011','100006466505528','100010718947632','100003721592401','100001687233614','100000323843939','100005535396546','100000261035049','100001380568029','100008393652930','100010027747387','100010900033292','100004798964670','100001782151064','100001205456448','100026089244314','100015891003359','100004067806447','100005346999363','100017307782359','100006509617684','100000152135532','100005380625527','100004237959583','1793140471','100003505220037','100000694056582','100002333045610','100003927808222','100021104113076','100001420867835','100003844724172','100007510743260','100010765142060','100005805944835','100007955958379','100011464642446','100004526112196','100002454408697','1677136898','100000926675349','100006811480524','100011383314895','100010507804834','100004023409166','100010015422753','100027530264663','100004569274571','1708674103','100006307922973','100005649870680','100004002108884','100005506389035','100004630246807','100006250599107','100004654004077','100013284497860','100005469275221','100001324523491','100018146804087','100015424247065','100005514880065','100004559677198','100004413638886','100006635138737','100008429534048','100007815032057','100005443062786','100000464490927','100000282736778','100004221843221','1816977811','100004719574338','100007544623670','100010786086394','100008035065005','100004434752455','100009232230729','100004666568279','100005952673484','100009747691328','100005813105084','100005478048981','100015640907995')
    GROUP BY a.id1,a.id2,d.PHONE_NUMBER ORDER BY a.id1 desc,SUM1 DESC
    ) a WHERE a.rownumber <= 30
) a 
LEFT JOIN F9_APP_INSIGHT.USER_PROFILE_ALL upa ON a.FRIEND_ID = upa.FACEBOOK_ID
LEFT JOIN F9_APP_INSIGHT.MQT_USER_COMPANY uc_b ON a.FACEBOOK_ID = uc_b.FACEBOOK_ID
LEFT JOIN F9_APP_INSIGHT.MQT_USER_COMPANY uc_c ON a.FRIEND_ID = uc_c.FACEBOOK_ID 
LEFT JOIN F9_APP_INSIGHT.USER_COLLEGE ucc_b ON a.FACEBOOK_ID = ucc_b.FACEBOOK_ID
LEFT JOIN F9_APP_INSIGHT.USER_COLLEGE ucc_c ON a.FRIEND_ID = ucc_c.FACEBOOK_ID 
GROUP BY a.FACEBOOK_ID,a.FRIEND_ID,a.PHONE_NUMBER,upa.NAME,a.SUM1 ORDER BY a.facebook_id,a.SUM1 DESC;
*/